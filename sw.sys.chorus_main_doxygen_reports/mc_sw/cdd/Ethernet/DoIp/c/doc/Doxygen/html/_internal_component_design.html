<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDD_DoIP: Internal Component Design</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDD_DoIP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Internal Component Design </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="InternalComponentDesign"></a>
Internal Component Design</h1>
<p>The component is splitted into the following SW units:</p><ul>
<li><b>DoIP_Main</b>: handles the reception of the DoIP frames from a client</li>
<li><b>DoIP_Server</b>: provides the functionality of processing the payload types</li>
<li><b>DoIP_Client</b>: provides the information about DoIP testers</li>
<li><b>DoIP_Msg</b>: implements the APIs for transmision of DoIP specific frames</li>
<li><b>DoIP_Dcm</b>: implements the processing of DoIP frames that needs to be addressed to local DCM instance</li>
<li><b>DoIP_TP</b>: provides handling of DoIP frames that need to be addressed to the local CAN stack</li>
<li><b>DoIP_Utils</b>: contains miscellaneous services useful for debugging</li>
<li><b>DoIP_LIN</b>: provide the functionality for routing the frames to DK2F nodes</li>
<li><b>DoIP_Int</b>: contains the public common defines for DoIP</li>
</ul>
<div class="image">
<img src="UnitComposition.png" alt="UnitComposition.png"/>
<div class="caption">
DoIP decomposition </div></div>
<h1><a class="anchor" id="SW"></a>
Requirements Allocation</h1>
<p>All the software requirements from the <b> SWR_ICAS1_BSW - <em> chapter 2.17.1 DoIP Application </em> </b> are assigned to DoIP from Chorus. SW requirements allocation is mentioned above, based on specific functionality of this module. All the software requirements assigned to DoIP are satisfied by subcomponentes mentioned. The software requirements can be traced on function level and it does not have any non functional requiremets.</p>
<h1><a class="anchor" id="SoftwareUnitInterfaces"></a>
Software Unit Interfaces</h1>
<p>The interfaces used internally between the SW units of this SW component are described in the following diagram: <br />
<br />
</p><div class="image">
<img src="Packages.png" alt="Packages.png"/>
</div>
<p> <br />
<br />
</p><div class="image">
<img src="Package2.png" alt="Package2.png"/>
</div>
<p> <br />
<br />
</p><div class="image">
<img src="Package3.png" alt="Package3.png"/>
</div>
<p> <br />
<br />
</p><div class="image">
<img src="Package4.png" alt="Package4.png"/>
<div class="caption">
The internal interfaces between the SW units of this SW component </div></div>
<p> <br />
<br />
 </p><div class="image">
<img src="SoftwareUnitInterfacesExternalInteraction.png" alt="SoftwareUnitInterfacesExternalInteraction.png"/>
<div class="caption">
Software Unit Interfaces External Interaction</div></div>
<h1><a class="anchor" id="SoftwareUnitInteraction"></a>
Software Unit Interaction</h1>
<p>The software unit interaction is mentioned in the above diagrams where is described the interaction of the SW units of the component.</p>
<h1><a class="anchor" id="SoftwareUnitDescription_1"></a>
Dynamic Behavior</h1>
<h2>Tasks</h2>
<p>Component has one cyclic task, <a class="el" href="_do_i_p___main_8h.html#ad667351d3525c3794d34f54b198171ea">DoIP_MainFunction</a> <br />
 </p><div class="image">
<img src="DynamicBehaviourMainFunction.png" alt="DynamicBehaviourMainFunction.png"/>
<div class="caption">
Cyclic function of DoIP component</div></div>
<p> <br />
<br />
 The behavior of the initialization function <a class="el" href="_do_i_p___main_8h.html#ab55dff640d015db2217e2eef6e86391d">DoIP_Init</a> is described below: <br />
</p>
<div class="image">
<img src="DynamicBehaviourInitFunction.png" alt="DynamicBehaviourInitFunction.png"/>
<div class="caption">
Init function of DoIP component</div></div>
<p>The connection between local DoIP and DoIP_Edge Node is implemented according with the following state diagram: <br />
</p><div class="image">
<img src="DoIPTester_StateMachine.png" alt="DoIPTester_StateMachine.png"/>
<div class="caption">
DoIP Tester state machine</div></div>
<p> <br />
<br />
</p><div class="image">
<img src="DoIP_StateMachine.png" alt="DoIP_StateMachine.png"/>
<div class="caption">
DoIP state machine</div></div>
<h1><a class="anchor" id="SoftwareUnitDescription_2"></a>
Data flow Diagram</h1>
<p>The diagrams below presents the major dataflow from the module.</p>
<div class="image">
<img src="data_flow_Doip_Req.png" alt="data_flow_Doip_Req.png"/>
<div class="caption">
DoIP Diag Request data flow </div></div>
<p> <br />
<br />
</p><div class="image">
<img src="data_flow_Doip_Resp.png" alt="data_flow_Doip_Resp.png"/>
<div class="caption">
DoIP Diag Response data flow </div></div>
<h2>Interrupts</h2>
<p>The DoIP module doesn't define or is using any interrupts.</p>
<h2>Shared Variables analysis</h2>
<p>The analysis of the shared variables used inside this functionality can be opened <a href="https://github-vni.geo.conti.de/bs-vw-meb-19-icas1-chorus/sw.sys.chorus_main_doc/tree/master/mc_sw/cdd/Ethernet/SoMgr/c/doc/Doxygen/Shared_Variable_SoMgr.docx">[here]</a> . <a href="https://github-vni.geo.conti.de/bs-vw-meb-19-icas1-chorus/sw.sys.chorus_main_doc/blob/master/mc_sw/cdd/Ethernet/DoIp/c/doc/Doxygen/Shared_Variable_DoIP.docx">https://github-vni.geo.conti.de/bs-vw-meb-19-icas1-chorus/sw.sys.chorus_main_doc/blob/master/mc_sw/cdd/Ethernet/DoIp/c/doc/Doxygen/Shared_Variable_DoIP.docx</a></p>
<h2>Events</h2>
<p>The processing done inside DoIP component is based mainly on events, like: </p><ul>
<li>
Reception of DoIP messages (requests) from <b>R7 DoIP EdgeNode</b>, which needs to be processed and routed to the destination  </li>
<li>
Reception DoIP messages (responses) from UDS server (DoIP/DoCAN/LIN node) which need to be forwarded to <b>R7</b>  </li>
</ul>
<p>The most complex processing is done for DoIP diagnostics data, payload type 0x8001 accordingly with ISO 13400-2 standard. <br />
</p><div class="image">
<img src="EventDiagRequestChorus.png" alt="EventDiagRequestChorus.png"/>
<div class="caption">
Reception of DoIP messages (requests)</div></div>
<p> <br />
<br />
</p><div class="image">
<img src="EventDiagResponseChorus.png" alt="EventDiagResponseChorus.png"/>
<div class="caption">
Reception of DoIP messages (response)</div></div>
<h2>Operating Modes</h2>
<p>The DoIP component is available only in normal/high-power operation mode because network communication is required for diagnostics. <br />
 Once the diagnostics session is established, then power management will be notified that is not allowed to leave the high-power mode until diagnostic communication is terminated. <br />
 </p><h2>Power Modes</h2>
<p>As mentioned in above chapter, the current functionality is available only in high-power mode.</p>
<h2>Exception and Error Handling</h2>
<p>The functions are handling errors via return value (e.g. E_NOT_OK). DoIp_Utils subcomponent has a global variable used to count each type of error, depending on the transmision/reception missbehavior in different usecases (<a class="el" href="_do_i_p___utils_8h.html#a5edb3b2e311711510cfa35013da04750">DoIP_ErrorType::DoIP_Error</a>). This variable is used just for error reporting side, so the error is detected and according error code incremented, without taking further actions.<br />
 Regarding error handling, the component doesn't take specific actions based on this statistics and it doesn't react in any way to a error raised. <br />
 </p><h2>Synchronization</h2>
<p>As mentioned in the chapter <b>Interrupts</b> there is no processing done at interrupt level in which the DoIP is involved. <br />
 Because the diagnose responses coming from Chorus DCM/ CAN ECUs/LIN ECUs are handled in different task (<b>Diag TASK</b>) there is the need to protect the sensitive data from corruption. A solution is under analysis, see <a href="https://jira-ibs.zone2.agileci.conti.de/browse/VWICAS23-21819">[VWICAS23-21819]</a> <br />
</p>
<h2>Operations</h2>
<p>The description of the operations done by DoIP are detailed in the header of each function. A list of methods defined inside this functionality can be accessed <a href="globals_func.html">here</a>.</p>
<h2>Macros</h2>
<p>There are no definitions of complex macros inside the functionality. Details about purpose and usage of existing macros are done inside source code. List of the currently defined macros <a href="globals_defs.html">here</a>.</p>
<h2>Algorithms</h2>
<p>The functionality doesn't make use of or implements a particular algorithm.</p>
<h2>Data Structures</h2>
<p>The more complex data structures used are provided at the following link <a href="annotated.html">Data structures </a> <br />
</p>
<h1><a class="anchor" id="SoftwareDesignEval"></a>
Evaluate Software Detailed Design</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Attribute  </th><th class="markdownTableHeadLeft">Value  </th><th class="markdownTableHeadLeft">Rational   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Interoperability  </td><td class="markdownTableBodyLeft">Medium  </td><td class="markdownTableBodyLeft">Can be used in different project but it has to be adapted   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Interaction  </td><td class="markdownTableBodyLeft">High  </td><td class="markdownTableBodyLeft">See Number of dependencies in <a class="el" href="_external_interfaces_dependencies.html">External Interfaces and Dependencies</a>.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Criticality  </td><td class="markdownTableBodyLeft">High  </td><td class="markdownTableBodyLeft">Due to high customer visibility of the functionality   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Technical complexity  </td><td class="markdownTableBodyLeft">Medium  </td><td class="markdownTableBodyLeft">Due to the fact that no complex algorithms are used in the implementation   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Risks  </td><td class="markdownTableBodyLeft">High  </td><td class="markdownTableBodyLeft">Because, for example, the car could not be flashed in case of malfunctions   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Testability  </td><td class="markdownTableBodyLeft">High  </td><td class="markdownTableBodyLeft">Testable completely on SWATT.Also,the requirements needs to be tested <br />
 at software level without needing of a complex setup in order test it.   </td></tr>
</table>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13, 1.8.14-->
<!-- start footer part -->
<hr class="footer"/>
<address class="footer">
  <small>
    Generated on Tue Aug 2 2022 09:56:12 for SDD_DoIP by &#160;
    <a>
      <img class="footer" src="doxygen.png" alt="doxygen"/>
    </a>
    1.8.14<br>
    <a>
      <img class="footer" src="../conti.png" alt="continental"/>
    </a>
  </small>
</address>
</body>
</html>
