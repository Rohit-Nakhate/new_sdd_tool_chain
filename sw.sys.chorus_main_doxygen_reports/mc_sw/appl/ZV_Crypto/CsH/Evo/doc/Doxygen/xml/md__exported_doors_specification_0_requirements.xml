<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.14">
  <compounddef id="md__exported_doors_specification_0_requirements" kind="page">
    <compoundname>md_ExportedDoorsSpecification_0_requirements</compoundname>
    <title>ExportedDoorsSpecification_0_requirements</title>
    <briefdescription>
<para>DOORS requirements. </para>    </briefdescription>
    <detaileddescription>
<para>DOORS requirements</para><sect1 id="md__exported_doors_specification_0_requirements_1ExportedDoorsSpecification_0">
<title>ExportedDoorsSpecification_0</title>
<para><linebreak/>
</para><sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_324">
<title>SWR_ICAS1_L3_CRY_324</title>
<para>Requirement is satisfied here: VAR <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_CryptoOperations.c line 250 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 1374 <linebreak/>
The ICAS1::CryptoHandler shall use a validity flag for the FFB_SKC. <linebreak/>
 The initial value (on ICAS1 delivery) of the validity flag for FFB_SKC shall be set to the value &quot;ungültig&quot; [/EN: &quot;invalid&quot;]. <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall store the FFB_SKC validity flag in ICAS1::NVM as per GATEWAY-943. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_324 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_325">
<title>SWR_ICAS1_L3_CRY_325</title>
<para>Requirement is satisfied here: VAR <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_CryptoOperations.c line 251 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 1375 <linebreak/>
The ICAS1::CryptoHandler shall use a validity flag for the key data. <linebreak/>
 The initial value (on ICAS1 delivery) of the validity flag for the key data shall be set to the value &quot;ungültig&quot; [/EN: &quot;invalid&quot;]. <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall store the FFB_Data validity flag in ICAS1::NVM as per GATEWAY-943. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_325 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_328">
<title>SWR_ICAS1_L3_CRY_328</title>
<para>Requirement is satisfied here: VAR <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_CryptoOperations.c line 252 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 1376 <linebreak/>
On ICAS1 delivery, all the storage locations of the FFB_SKC shall be filled with zeroes. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_328 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_329">
<title>SWR_ICAS1_L3_CRY_329</title>
<para>Requirement is satisfied here: VAR <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_CryptoOperations.c line 253 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 1377 <linebreak/>
On ICAS1 delivery, all the storage locations of the FFB data shall be filled with zeroes. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_329 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_330">
<title>SWR_ICAS1_L3_CRY_330</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1aa6089680f8887fc9c03b3a6e50811201" kindref="member">CSH_CheckDtc_035819Status</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 603 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1438 <linebreak/>
On ICAS1 delivery, the diagnostic trouble code 0x035819 (&quot;Funkfernbedienung-&gt;keine Grundeinstellung / Adaption&quot; [/EN: &quot;Radio remote control-&gt;no basic setting/adaption&quot;]) is set in order to indicate that no FFB_SKC and no keys are learned on the BCM. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_330 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_636">
<title>SWR_ICAS1_L3_CRY_636</title>
<para>Requirement is satisfied here: VAR <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_CryptoOperations.c line 254 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 1378 <linebreak/>
On ICAS1 delivery, all the number of learned FFB keys shall equal 0: <linebreak/>
 - numNA := 0 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_636 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_521">
<title>SWR_ICAS1_L3_CRY_521</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 151 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 388 <linebreak/>
Scenario <linebreak/>
 <linebreak/>
 For the FFB_SKC Learning function, ICAS1::CryptoHandler shall operate according to the following scenario: <linebreak/>
 <linebreak/>
 1. ICAS1::CryptoHandler receives the FFB_SKC from ICAS1::WFS. <linebreak/>
 2. ICAS1::CryptoHandler sets the FFB_SKC and FFB_Key validation flags to &quot;invalid&quot;. <linebreak/>
 3. ICAS1::CryptoHandler deletes previously stored FFB_SKC. <linebreak/>
 4. ICAS1::CryptoHandler sets DTC_ZV_Funk_keine_Grundeinstellung_Adaption DTC. <linebreak/>
 5. ICAS1::CryptoHandler deletes previously stored FFB data. <linebreak/>
 6. ICAS1::CryptoHandler stores the FFB_SKC in non-volatile memory of ICAS1 and SAM <linebreak/>
 7. ICAS1::CryptoHandler sets the FFB_SKC validity flag to &quot;valid&quot;. <linebreak/>
 8. ICAS1::CryptoHandler provides the UHF Channel Configuration data to WFS (as described in _462) <linebreak/>
 9. ICAS1::CryptoHandler forwards the FFB_SKC validity flag and ICAS1-configured key type and frequency to SAM <linebreak/>
 10. ICAS1::CryptoHandler responds to ICAS1::WFS with FFBUebertragungResp(E_OK) response. <linebreak/>
 11. ICAS1::CryptoHandler broadcasts the number of learnt keys to other functions (i.e., zero keys). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 The steps of this scenario are specified as individual requirements further in this section. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_521 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_332">
<title>SWR_ICAS1_L3_CRY_332</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 145 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 382 <linebreak/>
Receiving FFB_SKC form WFS <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall be able to receive the FFB_SKC from ICAS1::WFS. <linebreak/>
 <linebreak/>
 For this reason, ICAS1::WFS calls ICAS1::CryptoHandler with FFBSKCUebertragung(rawFFB_SKC). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 The transmission format of the FFB_SKC is defined in WFS requirements specification. <linebreak/>
 WFS: Wehfahrsperre (immobilizer) <linebreak/>
 ID: SWR_ICAS1_L3_CRY_332 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_335">
<title>SWR_ICAS1_L3_CRY_335</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 146 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 383 <linebreak/>
Resetting FFB_SKC Validation Flag <linebreak/>
 <linebreak/>
 IF <linebreak/>
 ICAS1::CryptoHandler received the FFB_SKC, <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall set the validity flag for the FFB_SKC to &quot;ungültig&quot; [/EN: &quot;invalid&quot;]. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_335 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_336">
<title>SWR_ICAS1_L3_CRY_336</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 147 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 384 <linebreak/>
Resetting FFB Key Data Validation Flag <linebreak/>
 <linebreak/>
 IF <linebreak/>
 ICAS1::CryptoHandler received the FFB_SKC, <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall set the validity flag for the FFB data to &quot;ungültig&quot; [/EN: &quot;invalid&quot;]. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_336 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_337">
<title>SWR_ICAS1_L3_CRY_337</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 148 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 385 <linebreak/>
Deleting FFB_SKC from NvM <linebreak/>
 <linebreak/>
 IF <linebreak/>
 ICAS1::CryptoHandler received the FFB_SKC <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall delete the previously stored FFB_SKC from the non-volatile memory at all storage locations <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Deleting refers to writing the memory slots for the FFB_SKC with zeroes &quot;0&quot;. <linebreak/>
 NVM: Non Volatile Memory <linebreak/>
 ID: SWR_ICAS1_L3_CRY_337 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_338">
<title>SWR_ICAS1_L3_CRY_338</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 149 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 386 <linebreak/>
Deleting FFB Data from NVM <linebreak/>
 <linebreak/>
 IF <linebreak/>
 ICAS1::CryptoHandler received the FFB_SKC <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall delete all the previously stored FFB data from the non-volatile memory of ICAS1. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Deleting refers to writing the memory slots for all the keys that can be theoretically learned with zeroes &quot;0&quot;. <linebreak/>
 The FFB data include the following data pertaining to each key learned in ICAS1: <linebreak/>
 - TransponderID <linebreak/>
 - Rolling Code Counter <linebreak/>
 - Key Battery Error Counter data (used by ICAS1::UHF-Master)* <linebreak/>
 - Last-Update data related to the Key Battery Error Counter data (used by ICAS1::UHF-Master)* <linebreak/>
 <linebreak/>
 *Follow <ulink url="http://rbg:8080/dwa/rm/urn:rational::1-43f9e04918531f6c-O-234-001595e6?doors.view=00000001">http://rbg:8080/dwa/rm/urn:rational::1-43f9e04918531f6c-O-234-001595e6?doors.view=00000001</ulink> to obtain more information on data used by ICAS1::UHF-Master. <linebreak/>
 These data are stored only in ICAS1::NVM and are not distributed to SAM. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_338 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_322">
<title>SWR_ICAS1_L3_CRY_322</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 150 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 387 <linebreak/>
Storing FFB_SKC in NvM <linebreak/>
 <linebreak/>
 AS SOON AS the following conditions are met: <linebreak/>
 - ICAS1::CryptoHandler received the FFB_SKC (according to _332). <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall trigger storing the new FFB_SKC to ICAS1:NVM (storing to a non-volatile memory). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Storing reveived FFB_SKC must be done after old value was cleared. <linebreak/>
 Storing to a non-volatile memory enables data to remain persistent over ICAS1 reset or after power off. <linebreak/>
 Storing to a non-volatile memory should be done immediately, meaning: as soon as preconditions are met and with high-priority request to minimize potential queuing in ICAS1::NVM (if possible). <linebreak/>
 To minimize read out by other applications, a client-server interface to ICAS1::NVM is used. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_322 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_339">
<title>SWR_ICAS1_L3_CRY_339</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 307 <linebreak/>
Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a2cecbce1949a3a83286ab128e4592d22" kindref="member">CSH_SetDTC_035819_IfKeysNotLearned</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 557 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 498 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1354 <linebreak/>
Setting DTC <linebreak/>
 <linebreak/>
 IF <linebreak/>
 ICAS1::CryptoHandler received the FFB_SKC <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall set the DTC_ZV_Funk_keine_Grundeinstellung_Adaption DTC on ICAS1::DEM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Diagnostic trouble code (DTC) is set to indicate that no keys are learned on the CDL. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_339 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_343">
<title>SWR_ICAS1_L3_CRY_343</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 152 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 389 <linebreak/>
Setting FFB_SKC Validity Flag <linebreak/>
 <linebreak/>
 IF <linebreak/>
 ICAS1::CryptoHandler stored the FFB_SKC successfully in the non-volatile memory of ICAS1, <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 the ICAS1::CryptoHandler shall set the validity flag for the FFB_SKC to &quot;gültig&quot; [/EN: &quot;valid]&quot;. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_343 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_716">
<title>SWR_ICAS1_L3_CRY_716</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1102 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1079 <linebreak/>
Forwarding FFB_SKC Validity Flag to SAM <linebreak/>
 <linebreak/>
 IF <linebreak/>
 ICAS1::CryptoHandler stored the FFB_SKC successfully in the non-volatile memory of ICAS1, <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 the ICAS1::CryptoHandler shall forward the value of the FFB_SKC validity flag to SAM, by setting: <linebreak/>
 - so_UHF_FFB_SKC_anlernen_can := 1 <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Please refer to CAN Matrix to obtain more information on the timing validity of this signal. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_716 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_717">
<title>SWR_ICAS1_L3_CRY_717</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1103 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1080 <linebreak/>
IF <linebreak/>
 ICAS1::CryptoHandler stored the FFB_SKC successfully in the non-volatile memory of ICAS1 <linebreak/>
 AND <linebreak/>
 - pc_Funkfrequenz == 0x1 <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 the ICAS1::CryptoHandler shall forward the ICAS1-configured Key type and frequency value to SAM by setting: so_UHF_FFB_Funkschluesseltyp_can := 0x1 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_717 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_719">
<title>SWR_ICAS1_L3_CRY_719</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1104 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1081 <linebreak/>
IF <linebreak/>
 ICAS1::CryptoHandler stored the FFB_SKC successfully in the non-volatile memory of ICAS1 <linebreak/>
 AND <linebreak/>
 - pc_Funkfrequenz == 0x2 <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 the ICAS1::CryptoHandler shall forward the ICAS1-configured Key type and frequency value to SAM by setting: so_UHF_FFB_Funkschluesseltyp_can := 0x2 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_719 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_720">
<title>SWR_ICAS1_L3_CRY_720</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1105 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1082 <linebreak/>
IF <linebreak/>
 ICAS1::CryptoHandler stored the FFB_SKC successfully in the non-volatile memory of ICAS1 <linebreak/>
 AND <linebreak/>
 - pc_Funkfrequenz == 0x3 <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 the ICAS1::CryptoHandler shall forward the ICAS1-configured Key type and frequency value to SAM by setting: so_UHF_FFB_Funkschluesseltyp_can := 0x3 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_720 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_721">
<title>SWR_ICAS1_L3_CRY_721</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1106 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1083 <linebreak/>
IF <linebreak/>
 ICAS1::CryptoHandler stored the FFB_SKC successfully in the non-volatile memory of ICAS1 <linebreak/>
 AND <linebreak/>
 - pc_Funkfrequenz != (0x1 || 0x2 || 0x3) <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 the ICAS1::CryptoHandler shall forward the ICAS1-configured Key type and frequency value to SAM by setting: so_UHF_FFB_Funkschluesseltyp_can := 0x0 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_721 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_344">
<title>SWR_ICAS1_L3_CRY_344</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1107 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1084 <linebreak/>
Reporting FFB_SKC Learning Success to WFS <linebreak/>
 <linebreak/>
 IF <linebreak/>
 ICAS1::CryptoHandler stored the FFB_SKC successfully in the non-volatile memory of ICAS1, <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall report to the ICAS1::WFS application that the learning process of the FFB_SKC is completed by <linebreak/>
 calling FFBSKCUebertragungResp(E_OK) function. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_344 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_511">
<title>SWR_ICAS1_L3_CRY_511</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1108 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1085 <linebreak/>
Notifying on Deletion of Learned Keys <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the FFB_SKC <linebreak/>
 <linebreak/>
 THEN <linebreak/>
 ICAS1::CryptoHandler shall provide the status on the number of learned keys (s_anzahl_angelernter_ffbs) to other functions (e.g., TKInt) by setting: <linebreak/>
 - numNA := 0 (notifying that all current keys were cleared). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 The following count as &quot;learned remote control keys&quot;: <linebreak/>
 Radio remote controls (regardless of the used protocol, i.e. MQB37W mode or legacy mode) <linebreak/>
 Kessy ID transmitter <linebreak/>
 Pure immobilizer transponders without CDL functionality are explicitly excluded. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_511 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_480">
<title>SWR_ICAS1_L3_CRY_480</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 308 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 499 <linebreak/>
Scenario <linebreak/>
 <linebreak/>
 For the FFB Key Learning function, ICAS1::CryptoHandler shall operate according to the following scenario. <linebreak/>
 <linebreak/>
 Precondition: <linebreak/>
 - ICAS1::CryptoHandler successfully executed the FFB_SKC Learning scenario (ICAS1::CryptoHandler checks if FFB_SKC flag is valid and FFB_Data flag is invalid) <linebreak/>
 <linebreak/>
 Flow: <linebreak/>
 1. ICAS1::CryptoHandler receives the FFB-Learning Crypts from ICAS1::WFS. <linebreak/>
 2. ICAS1::CryptoHandler verifies validity of FFB_SKC flag and FFB_Data flag. <linebreak/>
 LOOP for each FFB-Learning Crypt: <linebreak/>
 3. ICAS1::CryptoHandler verifies if FFB-learning crypt is valid (not zeroed) and consistent with ICAS1 configuration (pc_Funkfrequenz). <linebreak/>
 4. ICAS1::CryptoHandler stores the Transponder ID of the FFB-learning crypt to non-volatile memory of ICAS1. <linebreak/>
 5. ICAS1::CryptoHandler stores the Rolling Counter of the FFB-learning crypt to non-volatile memory of ICAS1. <linebreak/>
 6. ICAS1::CryptoHandler increments the number of learned FFB-Learning Crypts. <linebreak/>
 LOOP END <linebreak/>
 7. ICAS1::CryptoHandler sets the FFB_Data flag validity to &quot;valid&quot;. <linebreak/>
 8. ICAS1::CryptoHandler distributes the Transponder IDs of the FFB-learning crypts to SAM over MEB_CCAN. <linebreak/>
 9. ICAS1::CryptoHandler responds to ICAS1::WFS with information about storing the FFB-key data. <linebreak/>
 10. ICAS1::CryptoHandler resets DTC_ZV_Funk_keine_Grndeinstllg_Adapt DTC. <linebreak/>
 11. End of use case. <linebreak/>
 <linebreak/>
 Exceptions: <linebreak/>
 2.E.1 FFB_SKC flag is invalid OR FFB_Data flag is valid: <linebreak/>
 .1 ICAS1::CryptoHandler aborts the scenario by responding with failure to ICAS1::WFS. <linebreak/>
 .2 End of exception handling. <linebreak/>
 <linebreak/>
 3.E.1 FFB-Learning Crypt is invalid or not consistent with ICAS1 configuration: <linebreak/>
 .1 ICAS1::CryptoHandler aborts the scenario by responding with failure to ICAS1::WFS. <linebreak/>
 .2 End of exception handling. <linebreak/>
 Note, in case of 3.E.1, ICAS1 may remain in inconsistent state (if some FFB-Learning Crypts were learned). For this reason, new FFB-Learning Crypt process must start from the FFB_SKC Learning process. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 The steps of this scenario are specified as individual requirements further in this section. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_480 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_381">
<title>SWR_ICAS1_L3_CRY_381</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 309 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 500 <linebreak/>
Receiving FFB-Learning Crypts from WFS <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall be able to receive the FFB-Learning Crypts from ICAS1::WFS. <linebreak/>
 <linebreak/>
 For this purpose, ICAS1::WFS calls ICAS1::CryptoHandler using client-server interface: <linebreak/>
 FFBDatenUebertragung(bFFBSchluesselNr1, ..., bFFBSchluesselNr8, rawFFBDatenPaket1, ..., rawFFBDatenPaket8). <linebreak/>
 <linebreak/>
 The transmission format of the FFB-learning data is defined in WFS requirements specification. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_381 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_691">
<title>SWR_ICAS1_L3_CRY_691</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 299 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 490 <linebreak/>
Wrong Value of FFB_SKC Flag <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received FFB-learning crypts from ICAS1::WFS (_381) <linebreak/>
 AND <linebreak/>
 - FFB_SKC validity flag is set to &quot;invalid&quot; (ICAS1::CryptoHandler FFB_SKC learning process has not completed successfully) <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall abort the learning process, by sending a negative response to ICAS1::WFS: <linebreak/>
 - FFBDatenUebertragungResp(E_NOT_OK). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_691 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_692">
<title>SWR_ICAS1_L3_CRY_692</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 300 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 491 <linebreak/>
Wrong Value of FFB_Data Flag <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received FFB-learning crypts from ICAS1::WFS (_381) <linebreak/>
 AND <linebreak/>
 - FFB_Data validity flag is set to &quot;valid&quot; (ICAS1::CryptoHandler has not deleted previous FFB_Data), <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall abort the learning process, by sending a negative response to ICAS1::WFS: <linebreak/>
 - FFBDatenUebertragungResp(E_NOT_OK). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_692 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_694">
<title>SWR_ICAS1_L3_CRY_694</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 302 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 493 <linebreak/>
Evaluating and Processing the FFB-Learning Crypts <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received FFB-learning crypts from ICAS1::WFS (_381) <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall evaluate and process AVAILABLE* FFB-Learning Crypts. <linebreak/>
 <linebreak/>
 After evaluation (_689) of the AVAILABLE Learning Crypt, ICAS1::CryptoHandler shall process this Learning Crypt according to the requirements within _640. Then, ICAS1::CryptoHandler shall continue evaluation and processing of the next FFB-Learning Crypt. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 *Availability of the FFB-Learning Crypt is denoted with input parameter value: bFFBSchluesselNr&lt;X&gt; == 1. If FFB-Learning Crypt is not available, then ICAS1::CryptoHandler clears all the data associated to this key (specified as a separate requirements). <linebreak/>
 Learning Crypt 1 is received in s_FFB1_Datenpaket (rawFFBDatenPaket1 argument of the FFBDatenUebertragung operation). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_694 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_533">
<title>SWR_ICAS1_L3_CRY_533</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 297 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 488 <linebreak/>
Invalid Learning Crypt <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - AVAILABLE FFB_Learning Crypt consists only of zeroes. <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall abort the learning process, by sending a negative response to ICAS1::WFS: <linebreak/>
 - FFBDatenUebertragungResp(E_NOT_OK). <linebreak/>
 <linebreak/>
 Note, <linebreak/>
 FFB-Learning Crypts that were successfully learned do not have to be removed. The new process of FFB-Learning must start again from FFB_SKC Learning scenario. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_533 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_693">
<title>SWR_ICAS1_L3_CRY_693</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 301 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 492 <linebreak/>
Key Type Inconsistent with ICAS1 Configuration <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - AVAILABLE rawDatenPacket&lt;X&gt;.KeyType != 0x0D <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall abort the learning process, by sending a negative response to ICAS1::WFS: <linebreak/>
 - FFBDatenUebertragungResp(E_NOT_OK). <linebreak/>
 <linebreak/>
 Note, <linebreak/>
 ICAS1::CryptoHandler shall extract the Key Type from each available FFB-Learning Crypt. <linebreak/>
 More info on how to extract the Key Type and values assigned to Key Type are presented in _346. <linebreak/>
 <linebreak/>
 FFB-Learning Crypts that were successfully learned do not have to be removed. The new process of FFB-Learning must start again from FFB_SKC Learning scenario. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_693 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_702">
<title>SWR_ICAS1_L3_CRY_702</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 303 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 871 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 494 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1810 <linebreak/>
Key Frequency Inconsistent with ICAS1 Configuration <linebreak/>
 <linebreak/>
 IF following condition is NOT fulfilled for the AVAILABLE FFB Learning-Crypt: <linebreak/>
 <linebreak/>
 ( <linebreak/>
 - rawDatenPacket&lt;X&gt;.KeyFrequency == 0x05 <linebreak/>
 AND <linebreak/>
 - pc_Funkfrequenz == 0x01 <linebreak/>
 ) <linebreak/>
 OR <linebreak/>
 ( <linebreak/>
 ( <linebreak/>
 - rawDatenPacket&lt;X&gt;.KeyFrequency == 0x06 <linebreak/>
 OR <linebreak/>
 - rawDatenPacket&lt;X&gt;.KeyFrequency == 0x07 <linebreak/>
 ) <linebreak/>
 AND <linebreak/>
 ( <linebreak/>
 - pc_Funkfrequenz == 0x02 <linebreak/>
 OR <linebreak/>
 - pc_Funkfrequenz == 0x03 <linebreak/>
 ) <linebreak/>
 ) <linebreak/>
 <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall abort the learning process, by sending a negative response to ICAS1::WFS: <linebreak/>
 - FFBDatenUebertragungResp(E_NOT_OK). <linebreak/>
 <linebreak/>
 Note, <linebreak/>
 ICAS1::CryptoHandler shall extract Key Frequency data from each available FFB-Learning Crypt. <linebreak/>
 More info on how to extract the Key Frequency and values assigned to Key Frequency are presented in _346. <linebreak/>
 <linebreak/>
 FFB-Learning Crypts that were successfully learned do not have to be removed. The new process of FFB-Learning must start again from FFB_SKC Learning scenario. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_702 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_386">
<title>SWR_ICAS1_L3_CRY_386</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 310 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 501 <linebreak/>
Storing Transponder ID to NVM <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall store the Transponder ID (s_FFB_TransponderID) of the received and AVAILABLE FFB-Learning Crypt in the ICAS1::NVM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Storing to a non-volatile memory enables data to remain persistent over ICAS1 reset or after power off. <linebreak/>
 ICAS1::CryptoHandler shall store Transponder ID to a non-volatile memory as soon as ICAS1::CryptoHandler evaluated that the FFB-Learnig Crypt is correct, and with high-priority request to minimize potential queuing in ICAS1::NVM (if possible). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_386 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_389">
<title>SWR_ICAS1_L3_CRY_389</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 311 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 502 <linebreak/>
Storing Rolling Counter to NVM <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall store transmitted Rolling Counter of the received and AVAILABLE FFB-Learning Crypt (s_FFB_Wechselcodezaehler) in the ICAS1::NVM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Storing to a non-volatile memory enables data to remain persistent over ICAS1 reset or after power off. <linebreak/>
 ICAS1::CryptoHandler shall store Rolling Counter to a non-volatile memory as soon as ICAS1::CryptoHandler evaluated that the FFB-Learnig Crypt is correct, and with high-priority request to minimize potential queuing in ICAS1::NVM (if possible). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_389 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_563">
<title>SWR_ICAS1_L3_CRY_563</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 298 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 489 <linebreak/>
Updating the Number of Learned Keys <linebreak/>
 <linebreak/>
 After storing the Transponder ID and Rolling Counter associated to the AVAILABLE FFB-Learning Crypts, ICAS1::CryptoHandler shall update the number of learned keys (s_anzahl_angelernter_ffbs) by setting: numNA++ <linebreak/>
 <linebreak/>
 The following count as &quot;learned remote control keys&quot;: <linebreak/>
 Radio remote controls (regardless of the used protocol, i.e. MQB37W mode or legacy mode) <linebreak/>
 Kessy ID transmitter <linebreak/>
 Pure immobilizer transponders without CDL functionality are explicitly excluded. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Currently, local variable for the number of learned keys is updated after each key has been learned. At the end of the learning process, this value is stored in ICAS1::NVM and is broadcasted on RTE (numNA). <linebreak/>
 Also, this value is read from ICAS1::NVM after power-off. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_563 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_705">
<title>SWR_ICAS1_L3_CRY_705</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 305 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 496 <linebreak/>
Clearing Transponder ID Data in NVM <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall clear the Transponder ID (s_FFB_TransponderID := 0) data associated to the UNAVAILABLE* FFB-Learning Crypt in ICAS1::NVM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 *FFB-Learning Crypt is UNAVAILABLE if bFFBSchluesselNr == 0. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_705 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_707">
<title>SWR_ICAS1_L3_CRY_707</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 306 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 497 <linebreak/>
Clearing Rolling Counter in NVM <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall clear the Rolling Counter data (s_FFB_Wechselcodezaehler := 0) data associated to the UNAVAILABLE* FFB-Learning Crypt in ICAS1::NVM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 *FFB-Learning Crypt is UNAVAILABLE if bFFBSchluesselNr == 0. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_707 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_391">
<title>SWR_ICAS1_L3_CRY_391</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 312 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 503 <linebreak/>
Setting FFB_Data Validity Flag <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received FFB-learning crypts from ICAS1::WFS (_381) <linebreak/>
 AND <linebreak/>
 - ICAS1::CryptoHandler evaluated (as per _689) and processed successfully (as per _640) all AVAILABLE FFB-Learning Crypts, <linebreak/>
 <linebreak/>
 THEN <linebreak/>
 ICAS1::CryptoHandler shall set the FFB_data validity flag to &quot;gültig&quot; [/EN: &quot;valid&quot;]. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_391 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_388">
<title>SWR_ICAS1_L3_CRY_388</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 295 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 945 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 486 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1896 <linebreak/>
Distributing Transponder IDs to SAM <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received FFB-learning crypts from ICAS1::WFS (_381) <linebreak/>
 AND <linebreak/>
 - ICAS1::CryptoHandler evaluated (as per _689) and processed successfully (as per _640) all AVAILABLE FFB-Learning Crypts, <linebreak/>
 <linebreak/>
 THEN <linebreak/>
 ICAS1::CryptoHandler shall distribute the Transponder IDs of the received and AVAILABLE FFB-Learning Crypt into the UHF transceiver chip at SAM. <linebreak/>
 <linebreak/>
 For this purpose, ICAS1::CryptoHandler shall distribute the Transponder IDs by sending the following signals over MEB_CCAN: <linebreak/>
 UHF_TranspID_01.UHF_TranspID_01 := &lt;TransponderID_01 data&gt;=&quot;&quot;&gt; <linebreak/>
 UHF_TranspID_01.UHF_TranspID_02 := &lt;TransponderID_02 data&gt;=&quot;&quot;&gt; <linebreak/>
 UHF_TranspID_02.UHF_TranspID_03 := &lt;TransponderID_03 data&gt;=&quot;&quot;&gt; <linebreak/>
 UHF_TranspID_02.UHF_TranspID_04 := &lt;TransponderID_04 data&gt;=&quot;&quot;&gt; <linebreak/>
 UHF_TranspID_03.UHF_TranspID_05 := &lt;TransponderID_05 data&gt;=&quot;&quot;&gt; <linebreak/>
 UHF_TranspID_03.UHF_TranspID_06 := &lt;TransponderID_06 data&gt;=&quot;&quot;&gt; <linebreak/>
 UHF_TranspID_04.UHF_TranspID_07 := &lt;TransponderID_07 data&gt;=&quot;&quot;&gt; <linebreak/>
 UHF_TranspID_04.UHF_TranspID_08 := &lt;TransponderID_08 data&gt;=&quot;&quot;&gt; <linebreak/>
 <linebreak/>
 Notes: <linebreak/>
 ICAS1::CryptoHandler sends these data in one batch to SAM only when all learning crypts are positively evaluated. Otherwise (any learning crypt is invalid), SAM is not updated. <linebreak/>
 If FFB-Learning Crypt is not available, then &lt;TransponderID_01 data&gt;=&quot;&quot;&gt; := 0. <linebreak/>
 The number of Transponder IDs sent to SAM by ICAS1::CryptoHandler must match the number of Transponder IDs received from ICAS1::WFS. <linebreak/>
 The order of Transponder IDs sent to SAM must match to the order of Transponder IDs received from ICAS1::WFS. <linebreak/>
 <linebreak/>
 TransponderID_X data are received from WFS within FFB-Learning Crypt as specified in _346. <linebreak/>
 The UHF transceiver carries out the wake-up handling via the detection of learned keys. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_388 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_733">
<title>SWR_ICAS1_L3_CRY_733</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 313 <linebreak/>
Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a40c26dd7dc98f245e67c7f98ad1b5e62" kindref="member">Resend_WCZ_to_FDH</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1232 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 504 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1317 <linebreak/>
Distributing RollingCodeCounters to ICAS1::FFBDataHandler <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received FFB-learning crypts from ICAS1::WFS (_381) <linebreak/>
 AND <linebreak/>
 - ICAS1::CryptoHandler evaluated (as per _689) and processed successfully (as per _640) all AVAILABLE FFB-Learning Crypts, <linebreak/>
 <linebreak/>
 THEN <linebreak/>
 ICAS1::CryptoHandler shall distribute RollingCodeCounters of the received and AVAILABLE FFB-Learning Crypt to ICAS1::FFBDataHandler. <linebreak/>
 <linebreak/>
 For this purpose, ICAS1::CryptoHandler shall call the operation evFFBDataExchange as defined in _734 <linebreak/>
 <linebreak/>
 Notes: <linebreak/>
 ICAS1::CryptoHandler sends these data only when all learning crypts are positively evaluated. <linebreak/>
 If FFB-Learning Crypt is not available, then ICAS1::CryptoHandler assigns 0 to RollingCodeCounter. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_733 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_736">
<title>SWR_ICAS1_L3_CRY_736</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 381 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 780 <linebreak/>
Feedback from ICAS1::FFBDataHandler <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall be able to receive the response from ICAS1::FFBDataHandler as specified in _735 about the status of storing RollingCodeCounters operation in ICAS1::FFBDataHandler. <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall continue the KeyLearning process only if positive feedback is received. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_736 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_392">
<title>SWR_ICAS1_L3_CRY_392</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1ace062134f569d31c8823e37c72dac460" kindref="member">FFBDatenUebertragungResp_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1186 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1210 <linebreak/>
Reporting on the FFB-Learning Crypt Success to WFS <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received FFB-learning crypts from ICAS1::WFS (_381) <linebreak/>
 AND <linebreak/>
 - ICAS1::CryptoHandler evaluated (as per _689) and processed successfully (as per _640) all AVAILABLE FFB-Learning Crypts, <linebreak/>
 <linebreak/>
 THEN <linebreak/>
 ICAS1::CryptoHandler shall report to the ICAS1::WFS application that the learning process of the key data is completed, by calling FFBDatenUebertragungResp(E_OK). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_392 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_393">
<title>SWR_ICAS1_L3_CRY_393</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_KeyLearning.h line 296 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 487 <linebreak/>
Resetting the DTC <linebreak/>
 <linebreak/>
 IF: <linebreak/>
 - ICAS1::CryptoHandler finished the FFB_SKC learning process (FFB_SKC_Flag==&quot;gültig&quot; [/EN: &quot;valid&quot;]) <linebreak/>
 AND <linebreak/>
 - ICAS1::CryptoHandler finished the FFB_Data learning process (FFB_Data_Flag=&quot;gültig&quot; [/EN: &quot;valid&quot;] AND ICAS1::CryptoHandler reported on the success of learning process to ICAS1::WFS), <linebreak/>
 THEN <linebreak/>
 ICAS1::CryptoHandler shall reset the DTC_ZV_Funk_keine_Grndeinstllg_Adapt DTC on ICAS1::DEM. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_393 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_397">
<title>SWR_ICAS1_L3_CRY_397</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 656 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 737 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 844 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 996 <linebreak/>
Request for Signature Check <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall be able to receive the request (evCheckSignatureReq) for checking the signature from the Requestor. <linebreak/>
 <linebreak/>
 For this purpose, requestor calls the ICAS1::CryptoHandler using client-server interface evCheckSignatureReq(bMarkerDirection, rawFreshnessValue, rawNutzdaten, numNutzdatenLength, rawSignatureToCheck, numSignatureLength), where: <linebreak/>
 - rawNutzdaten: max 32 bytes being the payload on which signature will be calculated <linebreak/>
 - numNutzdatenLength: 1 byte denoting the length of the payload (0..32) <linebreak/>
 - rawSignatureToCheck: max 6 bytes being the Signature (6 bytes for KESSY telegram, 4 bytes filled with 0 at the end for FZV telegram) <linebreak/>
 - numSignatureLength: 1 byte denoting the length of the Signature (4..6). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Currently defined requestors include: <linebreak/>
 - ICAS1::KESSY-SW <linebreak/>
 - FFB_DataHandler <linebreak/>
 The &quot;Signaturprüfung&quot; [/EN: &quot;signature check&quot;] function must be designed to be manipulation-proof, so that the result cannot be manipulated by others. This is realized by using client-server interfaces to Requestors. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_397 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_399">
<title>SWR_ICAS1_L3_CRY_399</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 658 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 739 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 846 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 998 <linebreak/>
FFB_SKC Invalid <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the request (evCheckSignatureReq) for checking the signature <linebreak/>
 AND <linebreak/>
 <linebreak/>
 - the validity flag for the FFB_SKC has the status &quot;ungültig&quot; [/EN: &quot;invalid&quot;], <linebreak/>
 <linebreak/>
 THEN <linebreak/>
 the ICAS1::CryptoHandler shall abort the Signature Check process and respond to the Requestor that the Signature Check process has not passed according to [_401]. <linebreak/>
 <linebreak/>
 Note, <linebreak/>
 The &quot;Signaturprüfung&quot; [/EN: &quot;signature check&quot;] function must be designed to be manipulation-proof, so that the result cannot be manipulated by others. This is realized by obtaining FFB_SKC from ICAS1::NVM. Reading ICAS1::NVM content to RAM is done when transitioning from Low Power mode to High Power mode. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_399 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_398">
<title>SWR_ICAS1_L3_CRY_398</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 657 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 738 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 845 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 997 <linebreak/>
Reading FFB_SKC from NVM <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the request (evCheckSignatureReq) for checking the signature <linebreak/>
 AND <linebreak/>
 - the validity flag for the FFB_SKC has the status &quot;gültig&quot; [/EN: &quot;valid&quot;], <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall read the FFB_SKC from the ICAS1::NVM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 The signature check is done based on the calculation rule in the requirements specification &quot;Schutz der FFB-Funkkommunikation&quot;. <linebreak/>
 The &quot;Signaturprüfung&quot; [/EN: &quot;signature check&quot;] function must be designed to be manipulation-proof, so that the result cannot be manipulated by others. This is realized by using client-server interfaces to ICAS1::NVM that stores the FFB_SKC. In practice, ICAS1::NVM memory is mirrored in RAM while transitioning from Low-Power Mode to High-Power Mode. In this requirement, FFB_SKC is read from RAM for performace reasons. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_398 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_400">
<title>SWR_ICAS1_L3_CRY_400</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 659 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 740 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 847 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 999 <linebreak/>
Checking the Signature <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the request (evCheckSignatureReq) for checking the signature <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall check if the signature received in rawSignatureToCheck is correct by comparing the rawSignatureToCheck to the signature that must be calculated with FFB_SKC on the InputVector. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 ICAS1::CryptoHander shall use the ICAS1::CSM for calculation and comparison of the signatures. For this purpose, ICAS1::CryptoHandler shall call ICAS1::CSM via the client-server interface CsmPi_MacVerify() implemented by ICAS1::CSM. <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler passes the FFB_SKC, InputVector, and rawSignatureToCheck as a parameters of CsmPi_MacVerify operation. ICAS1::CryptoHandler creates an InputVector by concatenating the following data in given order: bMarkerDirection, rawFreshnessValue, rawNutzdaten. <linebreak/>
 <linebreak/>
 The signature check is done based on the calculation rule in the requirements specification &quot;Schutz der FFB-Funkkommunikation&quot;. <linebreak/>
 The &quot;Signaturprüfung&quot; [/EN: &quot;signature check&quot;] function must be designed to be manipulation-proof, so that the result cannot be manipulated by others. This is realized by using client-server interfaces to ICAS1::CSM that implements the signature calculation, and to ICAS1::NVM that stores the FFB_SKC. <linebreak/>
 Signatures are computed by means of the AES-CMAC procedure <linebreak/>
 ID: SWR_ICAS1_L3_CRY_400 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_401">
<title>SWR_ICAS1_L3_CRY_401</title>
<para>Requirement is satisfied here: :Rte_Call_CsH_KYBCM_Ev_StCryptoKY_evEncryptResp <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 228 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 660 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 741 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 289 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 848 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 1000 <linebreak/>
Reporting the Result of Signature Check to the Requestor <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall report the result of the signature check to the calling application (Requestor) on the client-server interface: evCheckSignatureResp(bSignatureValid, numCheckSignatureStatus), <linebreak/>
 where: <linebreak/>
 -bSignatureValid is a boolean value denoting: <linebreak/>
 0: Check not passed; <linebreak/>
 1: Signature valid. <linebreak/>
 - numCheckSignatureStatus: Status of the Signature Check function: <linebreak/>
 0: Signature check executed <linebreak/>
 1: Signature check canceled/not possible <linebreak/>
 2: Pending <linebreak/>
 3: Init <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 The &quot;Signaturprüfung&quot; [/EN: &quot;signature check&quot;] function must be designed to be manipulation-proof, so that the result cannot be manipulated by others. This is realized by using client-server interfaces to ICAS1::CSM that implements the signature calculation, and to ICAS1::NVM that stores the FFB_SKC. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_401 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_405">
<title>SWR_ICAS1_L3_CRY_405</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 513 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 585 <linebreak/>
Request for Signature Calculation <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall be able to receive the request (evCalcSignatureReq) from Requestor for calculating the signature of the user data (payload). <linebreak/>
 <linebreak/>
 For this purpose, Requestor calls the ICAS1::CryptoHandler using client-server interface evCalcSignatureReq(bMarkerDirection, rawFreshnessValue, rawNutzdaten, numNutzdatenLength), where: <linebreak/>
 - rawNutzdaten: max 32 bytes being the payload on which signature will be calculated <linebreak/>
 - numNutzdatenLength: 1 byte denoting the length of the payload (0..32). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Currently ICAS1::KESSY-SW is used as a requestor. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_405 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_408">
<title>SWR_ICAS1_L3_CRY_408</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 516 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 588 <linebreak/>
FFB_SKC Invalid <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the request (evCalcSignatureReq) for triggering signature calculation <linebreak/>
 AND <linebreak/>
 - the validity flag for the FFB_SKC has the status &quot;ungültig&quot; [/EN: &quot;invalid&quot;], <linebreak/>
 THEN <linebreak/>
 the ICAS1::CryptoHandler shall abort the Signature Calculation process and respond to the Requestor that the Signature Check process has not passed according to [_409]. For this purpose, ICAS1::CryptoHandler shall set the rawSignatureResult to 0. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Currently ICAS1::KESSY-SW is used as a requestor. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_408 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_406">
<title>SWR_ICAS1_L3_CRY_406</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 514 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 586 <linebreak/>
Reading FFB_SKC from NVM <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the request (evCalcSignatureReq) for triggering signature calculation <linebreak/>
 AND <linebreak/>
 - the validity flag for the FFB_SKC has the status &quot;gültig&quot; [/EN: &quot;valid&quot;], <linebreak/>
 THEN, <linebreak/>
 the ICAS1::CryptoHandler shall read the FFB_SKC from the reset- and manipulation-proof memory of the ICAS1::NVM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 The signature calculation is done based on the calculation rule in the requirements specification &quot;Schutz der FFB-Funkkommunikation&quot;. <linebreak/>
 The Signature calculation function must be designed to be manipulation-proof, so that the result cannot be manipulated by others. This is realized by using client-server interfaces to ICAS1::NVM that stores the FFB_SKC. In practice, ICAS1::NVM memory is mirrored in RAM while transitioning from Low-Power Mode to High-Power Mode. In this requirement, FFB_SKC is read from RAM for performace reasons. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_406 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_407">
<title>SWR_ICAS1_L3_CRY_407</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 515 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 587 <linebreak/>
Calculating the Signature <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the request (evCalcSignatureReq) for triggering Signature calculation <linebreak/>
 AND <linebreak/>
 - the validity flag for the FFB_SKC has the status &quot;gültig&quot; [/EN: &quot;valid&quot;], <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall calculate the Signature for the InputVector based on the FFB_SKC. <linebreak/>
 ICAS1::CryptoHander shall use the ICAS1::CSM for calculation of the signature, by calling ICAS1::CSM via the client-server interface CsmPi_MacGenerate(). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 ICAS1::CryptoHandler creates an InputVector by concatenating the following data in given order: bMarkerDirection, rawFreshnessValue, rawNutzdaten. <linebreak/>
 <linebreak/>
 The signature calculation is done based on the calculation rule in the requirements specification &quot;Schutz der FFB-Funkkommunikation&quot;. <linebreak/>
 The &quot;Signaturberechnung&quot; [/EN: &quot;signature calculation&quot;] function must be designed to be manipulation-proof, so that the result cannot be manipulated by others. This is realized by using client-server interfaces to ICAS1::CSM that implements the signature calculation, and to ICAS1::NVM that stores the FFB_SKC. <linebreak/>
 Signatures are computed by means of the AES-CMAC procedure <linebreak/>
 ID: SWR_ICAS1_L3_CRY_407 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_409">
<title>SWR_ICAS1_L3_CRY_409</title>
<para>Requirement is satisfied here: :Rte_Call_CsH_KYBCM_Ev_StCryptoKY_evCheckRSADSignatureResp<linebreak/>
 <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 142 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 517 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 229 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 589 <linebreak/>
Reporting the Result of Signature Calculation to ICAS1::KESSY-SW <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall report the result of the signature calculation to the calling application (Requestor) on the client-server interface: evCalcSignatureResp(rawSignatureResult, numCalcSignatureStatus), <linebreak/>
 where: <linebreak/>
 - rawSignatureResult: 6 bytes containing the calculated signature. <linebreak/>
 - numCalcSignatureStatus: Status of the Signature Calculation function: <linebreak/>
 0: Signature calculation executed <linebreak/>
 1: Signature calculation canceled/not possible <linebreak/>
 2: Pending <linebreak/>
 3: Init <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 ICAS1 extracts first 6 bytes of the 16B signature by CSM for the usage in rawSignatureResult. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Currently, ICAS1::KESSY-SW is considered as a Requestor. <linebreak/>
 The signature calculation is done based on the calculation rule in the requirements specification &quot;Schutz der FFB-Funkkommunikation&quot;. <linebreak/>
 The &quot;Signaturberechnung&quot; [/EN: &quot;signature calculation&quot;] function must be designed to be manipulation-proof, so that the result cannot be manipulated by others. This is realized by using client-server interfaces to the Requestor. <linebreak/>
 In the case of an error, the ICAS1::CryptoHandler signals a function abort to the calling application. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_409 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_538">
<title>SWR_ICAS1_L3_CRY_538</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 579 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 718 <linebreak/>
Request for RSAD Signature Check <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall be able to receive the request from Requestor (evCheckRSADSignatureReq, see _608) for checking the RSAD signature. <linebreak/>
 <linebreak/>
 For this purpose, ICAS1::KESSY-SW calls the ICAS1::CryptoHandler using client-server interface evCheckRSADSignatureReq(rawInputData, numInputDataLength, rawSignatureToCheck, numSignatureLength), where: <linebreak/>
 - rawInputData: max 32 bytes being the payload on which signature will be calculated <linebreak/>
 - numInputDataLength: 1 byte denoting the length of the payload (0..255) <linebreak/>
 - rawSignatureToCheck: max 6 bytes being the Signature to be checked <linebreak/>
 - numSignatureLength: 1 byte denoting the length of the Signature (4..6). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Currently, ICAS1::KESSY-SW is considered as a Requestor. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_538 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_541">
<title>SWR_ICAS1_L3_CRY_541</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 580 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 719 <linebreak/>
Checking the RSAD Signature <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the request (evCheckRSADSignatureReq) for RSAD Signature check <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall check if the signature received in rawSignatureToCheck is correct by comparing the rawSignatureToCheck to the signature that must be calculateded with RSAD_SKC on the rawInputData. <linebreak/>
 <linebreak/>
 ICAS1::CryptoHander shall use the ICAS1::CSM for calculation and comparison of the signatures. For this purpose, ICAS1::CryptoHandler shall call ICAS1::CSM via the client-server interface CsmPi_MacVerify (see _935) implemented by ICAS1::CSM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 ICAS1::CryptoHandler passes the RSAD_SKC, rawInputData, numInputDataLength, rawSignatureToCheck, and numSignatureLength as parameters of CsmPi_MacVerify operation. ICAS1::CSM returns result of the signature check in resultBuffer parameter. <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler obtains the RSAD_SKC from ICAS1::VKMS. For this purpose, ICAS1::CryptoHandler calls the VKMS_GetKey (typeId, keyLength, key) operation (see _932) on ICAS1::VKMS. ICAS1::CryptoHandler provides the typeId = &lt;RSAD_SKC identifier&gt;=&quot;&quot;&gt; (see key IDs configured in ICAS1::VKMS). ICAS1::VKMS provides the values of keyLength and key (pointers to the data). <linebreak/>
 <linebreak/>
 Note: If VKMS_GetKey is called, ICAS1::CryptoHandler must also check the key status in ICAS1::VKMS, by calling VKMS_isTypeIDReady (see _934). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_541 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_931">
<title>SWR_ICAS1_L3_CRY_931</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 581 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 720 <linebreak/>
Checking the RSAD Signature <linebreak/>
 <linebreak/>
 IF <linebreak/>
 - ICAS1::CryptoHandler received the request evCheckRSADSignatureReq (see _608) for RSAD Signature check <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall check if the signature received in rawSignatureToCheck is correct by comparing the rawSignatureToCheck to the signature that must be calculateded with RSAD_SKC on the rawInputData. <linebreak/>
 <linebreak/>
 ICAS1::CryptoHander shall use the ICAS1::CSM for calculation and comparison of the signatures. For this purpose, ICAS1::CryptoHandler shall call ICAS1::CSM via the client-server interface Csm_MacVerify (_935) implemented by ICAS1::CSM. <linebreak/>
 <linebreak/>
 NOTE: This requirement replaces _541 for ICAS1Evo A152 onwards. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_931 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_539">
<title>SWR_ICAS1_L3_CRY_539</title>
<para>Requirement is satisfied here: :Rte_Call_CsH_KYBCM_Ev_StCryptoKY_evCheckSignatureResp<linebreak/>
 <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 185 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 582 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 258 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 721 <linebreak/>
Reporting the Result of the RSAD Signature Check <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall report the result of the RSAD Signature check to the calling application on the client-server interface: evCheckRSADSignatureResp(bSignatureValid, numCheckSignatureStatus), (see _609). <linebreak/>
 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_539 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_542">
<title>SWR_ICAS1_L3_CRY_542</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 347 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 351 <linebreak/>
Request for Data Encryption from ICAS1::KESSY-SW <linebreak/>
 The ICAS1::CryptoHandler shall be able to receive the request for data encryption (evEncryptReq) from Requestor. <linebreak/>
 <linebreak/>
 For this purpose, Requestor calls the ICAS1::CryptoHandler using client-server interface evEncryptReq(rawInputData, enSKC, rawKey), see _610, where: <linebreak/>
 - rawInputData: 16 bytes of data to be encrypted <linebreak/>
 - enSKC: 1 byte denoting the type of Key used for encryption (0..2), where: <linebreak/>
 0: Custom Key included in rawKey parameter <linebreak/>
 1: FFB-SKC <linebreak/>
 2: RSAD-SKC, <linebreak/>
 - rawKey: 16 bytes containing the Custom Key (must be provided in case enSKC == 0). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 Currently, ICAS1::KESSY-SW is considered as a Requestor. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_542 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_545">
<title>SWR_ICAS1_L3_CRY_545</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 348 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 352 <linebreak/>
Reading FFB_SKC from NVM <linebreak/>
 <linebreak/>
 IF: <linebreak/>
 - requested key-type is FFB-SKC <linebreak/>
 AND <linebreak/>
 - FFB-SKC validity flag == &quot;valid&quot;, <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall obtain the FFB-SKC from the ICAS1::NVM. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 This is realized by using client-server NvM_ReadBlock() interface from ICAS1::NVM that stores the FFB_SKC. In practice, ICAS1::NVM memory is mirrored in RAM while transitioning from Low-Power Mode to High-Power Mode. In this requirement, FFB_SKC is read from RAM for performace reasons. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_545 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_549">
<title>SWR_ICAS1_L3_CRY_549</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 349 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 353 <linebreak/>
FFB-SKC Invalid <linebreak/>
 <linebreak/>
 IF: <linebreak/>
 - requested key-type is FFB-SKC <linebreak/>
 AND <linebreak/>
 - FFB-SKC validity flag == &quot;invalid&quot;, <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall abort the encryption operation and respond Requestor with an error [_544]. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_549 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_553">
<title>SWR_ICAS1_L3_CRY_553</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 352 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 356 <linebreak/>
Triggering Encryption with FFB_SKC <linebreak/>
 <linebreak/>
 IF: <linebreak/>
 - requested key-type is FFB-SKC <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler execute the encryption operation by calling ICAS1::CSM on the following client-server interface: <linebreak/>
 CsmPi_SymBlockEncrypt(keyPtr, dataPtr, dataLength, resultPtr, resultLengthPtr), where: <linebreak/>
 keyPtr: a valid FFB_SKC retrieved from ICAS1::NVM <linebreak/>
 dataPtr: input data vector <linebreak/>
 dataLength: length of the input data vector <linebreak/>
 resutPtr: output data vector (encrypted data) <linebreak/>
 resultLengthPtr: length of the output data vector <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 For more detail about the CsmPi interface to be used, please follow: <linebreak/>
 <ulink url="https://mspe.conti.de/projects/DG-054944/Project%20Documents/110%20Engineering/045%20Funtion%20Engineering/30_Functions/2_Zugangskontrolle/2_System_Archtecture/CsmPi_User_Manual.pdf">https://mspe.conti.de/projects/DG-054944/Project%20Documents/110%20Engineering/045%20Funtion%20Engineering/30_Functions/2_Zugangskontrolle/2_System_Archtecture/CsmPi_User_Manual.pdf</ulink> <linebreak/>
 <linebreak/>
 For more information about the Symmetrical block interface, please follow: <linebreak/>
 <ulink url="https://www.autosar.org/fileadmin/user_upload/standards/classic/4-2/AUTOSAR_SWS_CryptoServiceManager.pdf">https://www.autosar.org/fileadmin/user_upload/standards/classic/4-2/AUTOSAR_SWS_CryptoServiceManager.pdf</ulink> <linebreak/>
 ID: SWR_ICAS1_L3_CRY_553 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_550">
<title>SWR_ICAS1_L3_CRY_550</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 350 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 354 <linebreak/>
Triggering Encryption with RSAD_SKC <linebreak/>
 <linebreak/>
 IF: <linebreak/>
 - requested key-type is RSAD-SKC <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler execute the encryption operation by calling ICAS1::CSM on the following client-server interface: <linebreak/>
 <linebreak/>
 CsmPi_SymBlockEncrypt(keyPtr, dataPtr, dataLength, resultPtr, resultLengthPtr), where: <linebreak/>
 keyPtr: RSAD_SKC <linebreak/>
 dataPtr: input data vector <linebreak/>
 dataLength: length of the input data vector <linebreak/>
 resutPtr: output data vector (encrypted data) <linebreak/>
 resultLengthPtr: length of the output data vector <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 For more detail about the CsmPi interface to be used, please follow: <linebreak/>
 <ulink url="https://mspe.conti.de/projects/DG-054944/Project%20Documents/110%20Engineering/045%20Funtion%20Engineering/30_Functions/2_Zugangskontrolle/2_System_Archtecture/CsmPi_User_Manual.pdf">https://mspe.conti.de/projects/DG-054944/Project%20Documents/110%20Engineering/045%20Funtion%20Engineering/30_Functions/2_Zugangskontrolle/2_System_Archtecture/CsmPi_User_Manual.pdf</ulink> <linebreak/>
 <linebreak/>
 For more information about the Symmetrical block interface, please follow: <linebreak/>
 <ulink url="https://www.autosar.org/fileadmin/user_upload/standards/classic/4-2/AUTOSAR_SWS_CryptoServiceManager.pdf">https://www.autosar.org/fileadmin/user_upload/standards/classic/4-2/AUTOSAR_SWS_CryptoServiceManager.pdf</ulink> <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 ICAS1::CryptoHandler obtains the RSAD_SKC from ICAS1::VKMS. For this purpose, ICAS1::CryptoHandler calls the VKMS_GetKey (typeId, keyLength, key) operation (see _932) on ICAS1::VKMS. ICAS1::CryptoHandler provides the typeId = &lt;RSAD_SKC identifier&gt;=&quot;&quot;&gt; (see key IDs configured in ICAS1::VKMS). ICAS1::VKMS provides the values of keyLength and key (pointers to the data). <linebreak/>
 <linebreak/>
 Note: If VKMS_GetKey is called, ICAS1::CryptoHandler must also check the key status in ICAS1::VKMS, by calling VKMS_isTypeIDReady (see _934). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_550 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_938">
<title>SWR_ICAS1_L3_CRY_938</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 353 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 357 <linebreak/>
Triggering Encryption with RSAD_SKC <linebreak/>
 <linebreak/>
 IF: <linebreak/>
 - requested key-type is RSAD-SKC <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall execute the encryption operation by calling Csm_Encrypt (see _937) client-server interface implemented by ICAS1::CSM. <linebreak/>
 <linebreak/>
 NOTE: This requirement replaces _550 for ICAS1Evo from A152 onwards. <linebreak/>
 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_938 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_551">
<title>SWR_ICAS1_L3_CRY_551</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 351 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 355 <linebreak/>
Triggering Encryption with Custom Key <linebreak/>
 <linebreak/>
 IF: <linebreak/>
 - requested key-type is Custom Key <linebreak/>
 AND <linebreak/>
 - rawKey parameter of evEncryptReq is not empty (does not contain zeroes) <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler execute the encryption operation by calling ICAS1::CSM on the following client-server interface: <linebreak/>
 CsmPi_SymBlockEncrypt(keyPtr, dataPtr, dataLength, resultPtr, resultLengthPtr), where: <linebreak/>
 keyPtr: rawKey (128-bit-length) <linebreak/>
 dataPtr: input data vector <linebreak/>
 dataLength: length of the input data vector <linebreak/>
 resutPtr: output data vector (encrypted data) <linebreak/>
 resultLengthPtr: length of the output data vector <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 For more detail about the CsmPi interface to be used, please follow: <linebreak/>
 <ulink url="https://mspe.conti.de/projects/DG-054944/Project%20Documents/110%20Engineering/045%20Funtion%20Engineering/30_Functions/2_Zugangskontrolle/2_System_Archtecture/CsmPi_User_Manual.pdf">https://mspe.conti.de/projects/DG-054944/Project%20Documents/110%20Engineering/045%20Funtion%20Engineering/30_Functions/2_Zugangskontrolle/2_System_Archtecture/CsmPi_User_Manual.pdf</ulink> <linebreak/>
 <linebreak/>
 For more information about the Symmetrical block interface, please follow: <linebreak/>
 <ulink url="https://www.autosar.org/fileadmin/user_upload/standards/classic/4-2/AUTOSAR_SWS_CryptoServiceManager.pdf">https://www.autosar.org/fileadmin/user_upload/standards/classic/4-2/AUTOSAR_SWS_CryptoServiceManager.pdf</ulink> <linebreak/>
 <linebreak/>
 Note, <linebreak/>
 ICAS1::CryptoHandler shall abort the encryption operation and respond Requestor with an error [_544] if rawKey contains only zeroes. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_551 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_544">
<title>SWR_ICAS1_L3_CRY_544</title>
<para>Requirement is satisfied here: :KessyEvMngr_setEvRequest <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 271 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 320 <linebreak/>
Providing Encrypted Data <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall provide the encrypted data vector (128-bit length) to Requestor using the client-server interface: evEncryptResp(rawEncryptResult, numEncryptStatus), where: <linebreak/>
 - rawEncryptResult: 16-bytes containing the encrypted data <linebreak/>
 - numEncryptStatus: 1-byte containing the status of the function (0..3), where: <linebreak/>
 0: Encryption in work <linebreak/>
 1: Encryption canceled/not possible <linebreak/>
 2: Pending <linebreak/>
 3: Init <linebreak/>
 <linebreak/>
 If encryption operation has failed, then ICAS1::CryptoHandler shall respond ICAS1::KESSY-SW with evEncryptResp(0, 1). <linebreak/>
 ID: SWR_ICAS1_L3_CRY_544 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_414">
<title>SWR_ICAS1_L3_CRY_414</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 432 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 479 <linebreak/>
Request for Challenge Generation <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall be able to receive the request from Requestor to generate the challenge. <linebreak/>
 For this purpose, Requestor calls the ICAS1::CryptoHandler using client-server interface <ref refid="_cs_h___crypto_operations_8h_1a00dfe1802961bc20cbfbf1f8de278801" kindref="member">evCalcChallengeReq()</ref>. <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 - This function is called without any arguments. <linebreak/>
 - Generation of a challenge is based on the calculation rule in the requirements specification &quot;Schutz der FFB--Funkkommunikation&quot; - for the application of the challenge/response method. <linebreak/>
 - HSM shall be used for calculating the challenge (this is managed by ICAS1::CSM). <linebreak/>
 - The function called determines the length of the challenge, meaning both the Requestor and ICAS1::CryptoHandler agree that challenge generated on request of this call will be 6-bytes long. <linebreak/>
 <linebreak/>
 Currently, Requestor is ICAS1::KESSY-SW. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_414 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_555">
<title>SWR_ICAS1_L3_CRY_555</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 433 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 480 <linebreak/>
Triggering Challenge Generation <linebreak/>
 <linebreak/>
 On request for Challenge Generation from Requestor, ICAS1::CryptoHandler shall trigger challenge generation using the following client-server interface of ICAS1::CSM: <linebreak/>
 CsmPi_RandomGenerate(cfgId, rawChallengeResult, resultLength), where: <linebreak/>
 - cfgId: Identifier of the CSM module <linebreak/>
 - rawChallengeResult: result of the challenge generation <linebreak/>
 - resultLength = 6 <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 ICAS1::CSM generates the challenge with the help of HSM. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_555 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_554">
<title>SWR_ICAS1_L3_CRY_554</title>
<para>Requirement is satisfied here: :Rte_Call_CsH_KYBCM_Ev_StCryptoKY_evCalcSignatureResp<linebreak/>
 <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 99 <linebreak/>
Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/inc/CsH_CryptoOperations.h line 434 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 204 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_CryptoOperations.c.test line 481 <linebreak/>
Providing the Challenge to ICAS1::KESSY-SW <linebreak/>
 <linebreak/>
 The ICAS1::CryptoHandler shall report the result of challenge generation to the calling application (Requestor) on the client-server interface: evCalcChallengeResp(rawChallengeResult, numCalcChallengeStatus), <linebreak/>
 where: <linebreak/>
 - rawChallengeResult: 6 bytes containing the generated Challenge. <linebreak/>
 - numCalcChallengeStatus: Status of the Challenge generation function: <linebreak/>
 0: Challenge generation executed <linebreak/>
 1: Challenge generation canceled/not possible <linebreak/>
 2: Pending <linebreak/>
 3: Init <linebreak/>
 <linebreak/>
 If challenge generation operation has failed, then ICAS1::CryptoHandler shall respond Requestor with evCalcChallengeResp(0, 1). <linebreak/>
 <linebreak/>
 Note: <linebreak/>
 ICAS1::KESSY-SW has the information that the Challenge provided with this function is 6-bytes long. <linebreak/>
 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_554 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_429">
<title>SWR_ICAS1_L3_CRY_429</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1109 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1086 <linebreak/>
Obtaining UHF Channel Configuration <linebreak/>
 <linebreak/>
 ICAS1::CryptoHandler shall read the value of pc_Funkfrequenz adaptation channel when pc_Funkfrequenz is changed. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_429 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_441">
<title>SWR_ICAS1_L3_CRY_441</title>
<para>Requirement is satisfied here: <ref refid="_cs_h___key_learning_8c_1a6bfa16b26796fe27b66ffec06d3cc82c" kindref="member">FFBSKCUebertragung_WFS_Response</ref> <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1110 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 1087 <linebreak/>
IF <linebreak/>
 ICAS1::CryptoHandler received the FFB_SKC (_38) <linebreak/>
 <linebreak/>
 THEN, <linebreak/>
 ICAS1::CryptoHandler shall provide the UHF-Channel Configuration to the ICAS1::WFS using an interface defined in [_420]. <linebreak/>
 ID: SWR_ICAS1_L3_CRY_441 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_431">
<title>SWR_ICAS1_L3_CRY_431</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1020 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 2003 <linebreak/>
IF: <linebreak/>
 pc_funkfrequenz == 0x1 (MQB37w: Japan, multichannel) <linebreak/>
 THEN: <linebreak/>
 s_schluesselkonfigurationsdaten.[bits0...1] := 3 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_431 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_432">
<title>SWR_ICAS1_L3_CRY_432</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1021 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 2004 <linebreak/>
IF: <linebreak/>
 pc_funkfrequenz == 0x2 (MQB37w: 434 MHz RdW + NAR, multichannel) <linebreak/>
 THEN: <linebreak/>
 s_schluesselkonfigurationsdaten.[bits0...1] := 1 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_432 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_433">
<title>SWR_ICAS1_L3_CRY_433</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1022 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 2005 <linebreak/>
IF: <linebreak/>
 pc_funkfrequenz == 0x3 (MQB37w: 434 MHz South Korea, 1 channel) <linebreak/>
 THEN: <linebreak/>
 s_schluesselkonfigurationsdaten.[bits0...1] := 2 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_433 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_434">
<title>SWR_ICAS1_L3_CRY_434</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1023 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 2006 <linebreak/>
IF (logical AND-connected): <linebreak/>
 pc_funkfrequenz != 0x1 <linebreak/>
 AND <linebreak/>
 pc_funkfrequenz != 0x2 <linebreak/>
 AND <linebreak/>
 pc_funkfrequenz != 0x3 <linebreak/>
 <linebreak/>
 THEN: <linebreak/>
 s_schluesselkonfigurationsdaten.[bits0...1] := 0 <linebreak/>
 ID: SWR_ICAS1_L3_CRY_434 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
<linebreak/>
</para></sect2>
<sect2 id="md__exported_doors_specification_0_requirements_1SWR_ICAS1_L3_CRY_435">
<title>SWR_ICAS1_L3_CRY_435</title>
<para>Requirement is satisfied here: FUNC <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/src/CsH_KeyLearning.c line 1024 <linebreak/>
Requirement is verified here: TRACE <linebreak/>
../../../../../../../../sw.sys.chorus_main_build/mc_sw/appl/ZV_Crypto/CsH/c/test/swut/CsH_KeyLearning.c.test line 2007 <linebreak/>
The ICAS1::CryptoHandler shall fill bits 2-6 of the key configuration data as following: <linebreak/>
 <linebreak/>
 s_schluesselkonfigurationsdaten.[bit2] := 0 <linebreak/>
 s_schluesselkonfigurationsdaten.[bit3] := 0 <linebreak/>
 s_schluesselkonfigurationsdaten.[bit4] := c_KESSY_UWB_Frequenzband_a_aktiv (UWB frequency 6.42 GHz) <linebreak/>
 s_schluesselkonfigurationsdaten.[bit5] := c_KESSY_UWB_Frequenzband_b_aktiv (UWB Frequenz 6.97 GHz) <linebreak/>
 s_schluesselkonfigurationsdaten.[bit6] := c_KESSY_UWB_Frequenzband_c_aktiv (UWB Frequenz 7.52 GHz) <linebreak/>
 s_schluesselkonfigurationsdaten.[bit7] := c_Fahrzeugplattform_MEB_aktiv (Rear coding MEB) <linebreak/>
 ID: SWR_ICAS1_L3_CRY_435 <linebreak/>
 _ObjectType: Requirement <linebreak/>
 ASIL: QM <linebreak/>
</para></sect2>
</sect1>
    </detaileddescription>
  </compounddef>
</doxygen>
